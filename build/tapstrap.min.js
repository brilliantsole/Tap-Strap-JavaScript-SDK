/**
 * @copyright Zack Qattan 2024
 * @license MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).TS={})}(this,(function(e){"use strict";function t(e,t,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(e):i?i.value:t.get(e)}function s(e,t,s,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,s):n?n.value=s:t.set(e,s),s}"function"==typeof SuppressedError&&SuppressedError;const i=!1,n="undefined"!=typeof window&&void 0!==window?.document,r="undefined"!=typeof process&&null!=process?.versions?.node,a=n&&navigator.userAgent||"";let o=!1;n?o=Boolean(navigator.bluetooth):r&&(o=!0);const c=n&&/Bluefy/i.test(a),h=n&&/WebBLE/i.test(a),l=n&&/Android/i.test(a),u=n&&/Safari/i.test(a)&&!/Chrome/i.test(a),d=n&&/iPad|iPhone|iPod/i.test(a),f=n&&/Macintosh/i.test(a),g=!n&&!r&&"undefined"!=typeof global&&"undefined"!=typeof Studio;var v,m,p,w,b=Object.freeze({__proto__:null,isAndroid:l,get isBluetoothSupported(){return o},isIOS:d,isInBluefy:c,isInBrowser:n,isInDev:i,isInLensStudio:g,isInNode:r,isInProduction:!0,isInWebBLE:h,isMac:f,isSafari:u});if(g){const e=function(...e){Studio.log(e.map((e=>new String(e))).join(","))};(w={}).log=e,w.warn=e.bind(w,"WARNING"),w.error=e.bind(w,"ERROR")}else w=console;if(!w.assert){const e=(e,...t)=>{e||w.warn(...t)};w.assert=e}if(!w.table){const e=(...e)=>{w.log(...e)};w.table=e}function y(){}const E=w.log.bind(w),D=w.warn.bind(w),M=w.error.bind(w),C=w.table.bind(w),S=w.assert.bind(w);class W{constructor(e){if(p.set(this,{log:i,warn:i,assert:!0,error:!0,table:!0}),t(v,v,"f",m)[e])throw new Error(`"${e}" console already exists`);t(v,v,"f",m)[e]=this}setLevelFlags(e){Object.assign(t(this,p,"f"),e)}static setLevelFlagsForType(e,s){if(!t(this,v,"f",m)[e])throw new Error(`no console found with type "${e}"`);t(this,v,"f",m)[e].setLevelFlags(s)}static setAllLevelFlags(e){for(const s in t(this,v,"f",m))t(this,v,"f",m)[s].setLevelFlags(e)}static create(e,s){return t(this,v,"f",m)[e]||new v(e)}get log(){return t(this,p,"f").log?E:y}get warn(){return t(this,p,"f").warn?D:y}get error(){return t(this,p,"f").error?M:y}get assert(){return t(this,p,"f").assert?S:y}get table(){return t(this,p,"f").table?C:y}assertWithError(e,t){if(!Boolean(e))throw new Error(t)}assertTypeWithError(e,t){this.assertWithError(typeof e==t,`value ${e} of type "${typeof e}" not of type "${t}"`)}assertEnumWithError(e,t){this.assertWithError(t.includes(e),`invalid enum "${e}"`)}}function k(e,t){return W.create(e,t)}v=W,p=new WeakMap,m={value:{}};const R=k("EventDispatcher",{log:!1});class L{constructor(e,t){this.target=e,this.validEventTypes=t,this.listeners={},this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.removeEventListeners=this.removeEventListeners.bind(this),this.removeAllEventListeners=this.removeAllEventListeners.bind(this),this.dispatchEvent=this.dispatchEvent.bind(this),this.waitForEvent=this.waitForEvent.bind(this)}isValidEventType(e){return this.validEventTypes.includes(e)}updateEventListeners(e){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter((t=>(t.shouldRemove&&R.log(`removing "${e}" eventListener`,t),!t.shouldRemove))))}addEventListener(e,t,s={once:!1}){if(!this.isValidEventType(e))throw new Error(`Invalid event type: ${e}`);this.listeners[e]||(this.listeners[e]=[],R.log(`creating "${e}" listeners array`,this.listeners[e]));this.listeners[e].find((e=>e.listener==t&&e.once==s.once))?R.log("already added listener"):(R.log(`adding "${e}" listener`,t,s),this.listeners[e].push({listener:t,once:s.once}),R.log(`currently have ${this.listeners[e].length} "${e}" listeners`))}removeEventListener(e,t){if(!this.isValidEventType(e))throw new Error(`Invalid event type: ${e}`);this.listeners[e]&&(R.log(`removing "${e}" listener...`,t),this.listeners[e].forEach((s=>{s.listener===t&&(R.log(`flagging "${e}" listener`,t),s.shouldRemove=!0)})),this.updateEventListeners(e))}removeEventListeners(e){if(!this.isValidEventType(e))throw new Error(`Invalid event type: ${e}`);this.listeners[e]&&(R.log(`removing "${e}" listeners...`),this.listeners[e]=[])}removeAllEventListeners(){R.log("removing listeners..."),this.listeners={}}dispatchEvent(e,t){if(!this.isValidEventType(e))throw new Error(`Invalid event type: ${e}`);this.listeners[e]&&(this.listeners[e].forEach((s=>{s.shouldRemove||(R.log(`dispatching "${e}" listener`,s),s.listener({type:e,target:this.target,message:t}),s.once&&(R.log(`flagging "${e}" listener`,s),s.shouldRemove=!0))})),this.updateEventListeners(e))}waitForEvent(e){return new Promise((t=>{this.addEventListener(e,(e=>{t(e)}),{once:!0})}))}}var I,A,$;const x=k("Timer",{log:!1});class T{get callback(){return t(this,I,"f")}set callback(e){x.assertTypeWithError(e,"function"),x.log({newCallback:e}),s(this,I,e,"f"),this.isRunning&&this.restart()}get interval(){return t(this,A,"f")}set interval(e){x.assertTypeWithError(e,"number"),x.assertWithError(e>0,"interval must be above 0"),x.log({newInterval:e}),s(this,A,e,"f"),this.isRunning&&this.restart()}constructor(e,t){I.set(this,void 0),A.set(this,void 0),$.set(this,void 0),this.interval=t,this.callback=e}get isRunning(){return null!=t(this,$,"f")}start(e=!1){this.isRunning?x.log("interval already running"):(x.log("starting interval"),s(this,$,setInterval(t(this,I,"f"),t(this,A,"f")),"f"),e&&t(this,I,"f").call(this))}stop(){this.isRunning?(x.log("stopping interval"),clearInterval(t(this,$,"f")),s(this,$,void 0,"f")):x.log("interval already not running")}restart(e=!1){this.stop(),this.start(e)}}var U,O;I=new WeakMap,A=new WeakMap,$=new WeakMap,U="undefined"==typeof TextEncoder?class{encode(e){const t=Array.from(e).map((e=>e.charCodeAt(0)));return Uint8Array.from(t)}}:TextEncoder,O="undefined"==typeof TextDecoder?class{decode(e){return Array.from(new Uint8Array(e)).map((e=>String.fromCharCode(e))).join("")}}:TextDecoder;const B=new U,N=new O;var F,j,V,G,_;const P=k("DeviceInformationManager",{log:!0}),z=["manufacturerName","modelNumber","softwareRevision","hardwareRevision","firmwareRevision","pnpId","serialNumber"],J=[...z,"deviceInformation"];class K{constructor(){F.add(this),V.set(this,{})}get information(){return t(this,V,"f")}clear(){s(this,V,{},"f")}parseMessage(e,s){switch(P.log({messageType:e}),e){case"manufacturerName":const i=N.decode(s.buffer);P.log({manufacturerName:i}),t(this,F,"m",_).call(this,{manufacturerName:i});break;case"modelNumber":const n=N.decode(s.buffer);P.log({modelNumber:n}),t(this,F,"m",_).call(this,{modelNumber:n});break;case"softwareRevision":const r=N.decode(s.buffer);P.log({softwareRevision:r}),t(this,F,"m",_).call(this,{softwareRevision:r});break;case"hardwareRevision":const a=N.decode(s.buffer);P.log({hardwareRevision:a}),t(this,F,"m",_).call(this,{hardwareRevision:a});break;case"firmwareRevision":const o=N.decode(s.buffer);P.log({firmwareRevision:o}),t(this,F,"m",_).call(this,{firmwareRevision:o});break;case"pnpId":const c={source:1===s.getUint8(0)?"Bluetooth":"USB",productId:s.getUint16(3,!0),productVersion:s.getUint16(5,!0),vendorId:0};"Bluetooth"==c.source&&(c.vendorId=s.getUint16(1,!0)),P.log({pnpId:c}),t(this,F,"m",_).call(this,{pnpId:c});break;case"serialNumber":const h=N.decode(s.buffer);P.log({serialNumber:h});break;default:throw Error(`uncaught messageType ${e}`)}}}V=new WeakMap,F=new WeakSet,j=function(){return this.eventDispatcher.dispatchEvent},G=function(){return z.every((e=>{switch(e){case"modelNumber":case"serialNumber":return!0;default:return e in t(this,V,"f")}}))},_=function(e){P.log({partialDeviceInformation:e});Object.keys(e).forEach((s=>{t(this,F,"a",j).call(this,s,{[s]:e[s]})})),Object.assign(t(this,V,"f"),e),P.log({deviceInformation:t(this,V,"f")}),t(this,F,"a",G)&&(P.log("completed deviceInformation"),t(this,F,"a",j).call(this,"deviceInformation",{deviceInformation:this.information}))};function X(e,{include:t,exclude:s}={}){const i=e=>{const i=t=>"string"==typeof t?e===t:t.test(e);return t?t.some(i):!s||!s.some(i)};for(const[t,s]of(e=>{const t=new Set;do{for(const s of Reflect.ownKeys(e))t.add([e,s])}while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t})(e.constructor.prototype)){if("constructor"===s||!i(s))continue;const n=Reflect.getOwnPropertyDescriptor(t,s);n&&"function"==typeof n.value&&(e[s]=e[s].bind(e))}return e}var q;const H=k("TapDataManager"),Q=["tapData"],Y=[...Q];class Z{constructor(){q.add(this),X(this)}parseMessage(e,t){if(H.log({messageType:e}),"tapData"!==e)throw Error(`uncaught messageType ${e}`)}}var ee;q=new WeakSet;const te=k("MouseDataManager"),se=["mouseData"],ie=[...se];class ne{constructor(){ee.add(this),X(this)}parseMessage(e,t){if(te.log({messageType:e}),"mouseData"!==e)throw Error(`uncaught messageType ${e}`)}}var re;ee=new WeakSet;const ae=k("AirGestureManager"),oe=["airGesture"],ce=[...oe];class he{constructor(){re.add(this),X(this)}parseMessage(e,t){if(ae.log({messageType:e}),"airGesture"!==e)throw Error(`uncaught messageType ${e}`)}}re=new WeakSet;const le=k("RawSensorUtils"),ue=["deviceAccelerometer","imuGyroscope","imuAccelerometer"],de={deviceAccelerometer:[31.25,3.90625,7.8125,15.625,31.25],imuGyroscope:[17.5,4.375,8.75,17.5,35,70],imuAccelerometer:[.122,.061,.122,.244,.488]},fe={deviceAccelerometer:0,imuGyroscope:0,imuAccelerometer:0},ge={imu:12,device:30};function ve(e,t){const s=de[e][t];le.assertWithError(null!=s,`invalid RawSensorSensitivity index ${t} for sensor "${e}" (got value ${s})`)}const me=k("ArrayBufferUtils",{log:!1});function pe(...e){const t=(e=(e=(e=e.filter((e=>null!=e||null!=e))).map((e=>{if("number"==typeof e){const t=e;return Uint8Array.from([Math.floor(t)])}if("boolean"==typeof e){const t=e;return Uint8Array.from([t?1:0])}if("string"==typeof e){return we(e)}if(e instanceof Array){return pe(...e)}if(e instanceof ArrayBuffer)return e;if("buffer"in e&&e.buffer instanceof ArrayBuffer){return e.buffer}if(e instanceof DataView){return e.buffer}if("object"==typeof e){return function(e){return we(JSON.stringify(e))}(e)}return e}))).filter((e=>e&&"byteLength"in e))).reduce(((e,t)=>e+t.byteLength),0),s=new Uint8Array(t);let i=0;return e.forEach((e=>{s.set(new Uint8Array(e),i),i+=e.byteLength})),s.buffer}function we(e){const t=B.encode(e);return pe(t.byteLength,t)}function be(e,t,s){let i;return null!=s&&(i=e.byteOffset+t+s),me.log({dataView:e,begin:t,end:i,length:s}),new DataView(e.buffer.slice(e.byteOffset+t,i))}var ye,Ee,De,Me;const Ce=k("RawSensorManager"),Se=["rawSensor"],We=[...Se,"imu","device"];class ke{constructor(){ye.add(this),X(this)}parseMessage(e,s){if(Ce.log({messageType:e}),"rawSensor"!==e)throw Error(`uncaught messageType ${e}`);t(this,ye,"m",De).call(this,s)}}var Re,Le,Ie;ye=new WeakSet,Ee=function(){return this.eventDispatcher.dispatchEvent},De=function(e){Ce.log("parsing whole",e);let s=0;for(;s+4<e.byteLength;){const i=e.getUint32(0,!0);s+=4,Ce.log({rawValue:i});const n=(2147483648&i)>>31,r=2147483647&i;if(Ce.log({firstBit:n,timestamp:r}),0==r)break;const a=0==n?"imu":"device";Ce.log({sensorDataType:a});const o=ge[a];if(Ce.log({sensorDataLength:o}),0==o)break;const c=be(e,s,o);c.byteLength==o&&t(this,ye,"m",Me).call(this,a,r,c),s+=o}},Me=function(e,s,i){Ce.log(`parsing ${e} ${s}ms`,i);let n="device"==e?"deviceAccelerometer":"imuGyroscope";const r=[];for(let t=0;t<i.byteLength;t+=6){const s=this.sensitivity[n],a=de[n][s],[o,c,h]=[i.getInt16(t+0,!0),i.getInt16(t+2,!0),i.getInt16(t+4,!0)].map((e=>e*a));Ce.log({x:o,y:c,z:h});const l={x:o,y:c,z:h};Ce.log("point",l),r.push(l),"imu"==e&&(n="imuAccelerometer")}let a=0;switch(e){case"imu":a=2;break;case"device":a=5}r.length==a?(t(this,ye,"a",Ee).call(this,e,{sensorDataType:e,points:r,timestamp:s}),t(this,ye,"a",Ee).call(this,"rawSensor",{sensorDataType:e,points:r,timestamp:s})):Ce.log(`invalid number of ${e} points (expected ${a}, get ${r.length})`)};const Ae=k("TxManager"),$e=["tx",...Se],xe=[...We];class Te{get eventDispatcher(){return t(this,Le,"f")}set eventDispatcher(e){s(this,Le,e,"f"),t(this,Ie,"f").eventDispatcher=e}set rawSensorSensitivity(e){t(this,Ie,"f").sensitivity=e}constructor(){Re.add(this),Le.set(this,void 0),Ie.set(this,new ke),X(this)}parseMessage(e,s){if(Ae.log({messageType:e}),"tx"!==e)throw Error(`uncaught messageType ${e}`);t(this,Ie,"f").parseMessage("rawSensor",s)}}var Ue,Oe,Be,Ne,Fe,je,Ve,Ge,_e;Le=new WeakMap,Ie=new WeakMap,Re=new WeakSet;const Pe=k("BaseConnectionManager",{log:!0}),ze=["notConnected","connecting","connected","disconnecting"],Je=[...ze,"connectionStatus","isConnected"];class Ke{get baseConstructor(){return this.constructor}static get isSupported(){return!1}get isSupported(){return this.baseConstructor.isSupported}get type(){return this.baseConstructor.type}constructor(){Ue.add(this),Be.set(this,"notConnected"),Ge.set(this,new T(t(this,Ue,"m",_e).bind(this),5e3)),t(this,Ue,"m",Oe).call(this)}get status(){return t(this,Be,"f")}set status(e){Pe.assertEnumWithError(e,ze),t(this,Be,"f")!=e?(Pe.log(`new connection status "${e}"`),s(this,Be,e,"f"),this.onStatusUpdated(this.status),this.isConnected?t(this,Ge,"f").start():t(this,Ge,"f").stop()):Pe.log(`tried to assign same connection status "${e}"`)}get isConnected(){return"connected"==this.status}async connect(){t(this,Ue,"m",Ne).call(this),t(this,Ue,"m",Fe).call(this),this.status="connecting"}get canReconnect(){return!1}async reconnect(){t(this,Ue,"m",Ne).call(this),t(this,Ue,"m",Fe).call(this),Pe.assert(this.canReconnect,"unable to reconnect")}async disconnect(){t(this,Ue,"m",je).call(this),t(this,Ue,"m",Ve).call(this),this.status="disconnecting",Pe.log("disconnecting from device...")}async sendUICommandsData(e){Pe.log("sendUICommandsData",e)}async sendRxData(e){Pe.log("sendRxData",e)}}Be=new WeakMap,Ge=new WeakMap,Ue=new WeakSet,Oe=function(){Pe.assertWithError(this.isSupported,`${this.constructor.name} is not supported`)},Ne=function(){Pe.assertWithError(!this.isConnected,"device is already connected")},Fe=function(){Pe.assertWithError("connecting"!=this.status,"device is already connecting")},je=function(){Pe.assertWithError(this.isConnected,"device is not connected")},Ve=function(){Pe.assertWithError("disconnecting"!=this.status,"device is already disconnecting")},_e=function(){this.isConnected||(Pe.log("timer detected disconnection"),this.status="notConnected")};const Xe=k("EventUtils",{log:!1});function qe(e,t){let s=e.addEventListener||e.addListener||e.on||e.AddEventListener;Xe.assertWithError(s,"no add listener function found for target"),s=s.bind(e),Object.entries(t).forEach((([e,t])=>{s(e,t)}))}function He(e,t){let s=e.removeEventListener||e.removeListener||e.RemoveEventListener;Xe.assertWithError(s,"no remove listener function found for target"),s=s.bind(e),Object.entries(t).forEach((([e,t])=>{s(e,t)}))}const Qe=k("bluetoothUUIDs",{log:!1});if(n)var Ye=window.BluetoothUUID;function Ze(e){return Qe.assertTypeWithError(e,"string"),Qe.assertWithError(1==e.length,"value must be 1 character long"),`C3FF000${e}-1D8B-40FD-A56F-C7BD5D0F3370`.toLowerCase()}function et(e){return Qe.assertTypeWithError(e,"string"),Qe.assertWithError(1==e.length,"value must be 1 character long"),`6E40000${e}-B5A3-F393-E0A9-E50E24DCCA9E`.toLowerCase()}function tt(e){return Ye?.getCharacteristic?.(e)}function st(e){return Ye?.getService?.(e)}const it=Object.freeze({services:{deviceInformation:{uuid:st("device_information"),characteristics:{manufacturerName:{uuid:tt("manufacturer_name_string")},modelNumber:{uuid:tt("model_number_string")},hardwareRevision:{uuid:tt("hardware_revision_string")},firmwareRevision:{uuid:tt("firmware_revision_string")},softwareRevision:{uuid:tt("software_revision_string")},pnpId:{uuid:tt("pnp_id")},serialNumber:{uuid:tt("serial_number_string")}}},battery:{uuid:st("battery_service"),characteristics:{batteryLevel:{uuid:tt("battery_level")}}},tap:{uuid:Ze("1"),characteristics:{tapData:{uuid:Ze("5")},mouseData:{uuid:Ze("6")},airGesture:{uuid:Ze("A")},uiCommands:{uuid:Ze("9")},settings:{uuid:Ze("2")},unknown3:{uuid:Ze("3")},unknown7:{uuid:Ze("7")},unknown8:{uuid:Ze("8")},unknownB:{uuid:Ze("B")},unknownC:{uuid:Ze("C")},unknownD:{uuid:Ze("D")}}},nus:{uuid:et("1"),characteristics:{rx:{uuid:et("2")},tx:{uuid:et("3")}}}}}),nt=[it.services.tap.uuid],rt=[it.services.deviceInformation.uuid,it.services.battery.uuid,it.services.nus.uuid];function at(e){e=e.toString().toLowerCase();return Object.keys(it.services).find((t=>{let s=it.services[t].uuid.toString();return 4==e.length&&(s=s.slice(4,8)),e.includes("-")||(s=s.replaceAll("-","")),e==s}))}const ot=[],ct=[];function ht(e){var t;return e=e.toString().toLowerCase(),Object.values(it.services).some((s=>{const i=Object.keys(s.characteristics);return t=i.find((t=>{let i=s.characteristics[t].uuid.toString();return 4==e.length&&(i=i.slice(4,8)),e.includes("-")||(i=i.replaceAll("-","")),e==i}))})),t}function lt(e){const t={broadcast:!1,read:!0,writeWithoutResponse:!1,write:!1,notify:!1,indicate:!1,authenticatedSignedWrites:!1,reliableWrite:!1,writableAuxiliaries:!1};switch(e){case"settings":case"tapData":case"mouseData":case"unknown7":case"unknown8":t.read=!1}switch(e){case"batteryLevel":case"tapData":case"mouseData":case"airGesture":case"unknown8":case"unknownB":case"unknownC":case"unknownD":case"tx":t.notify=!0}switch(e){case"airGesture":case"uiCommands":case"unknown7":case"unknownB":t.writeWithoutResponse=!0}switch(e){case"settings":case"unknown3":case"unknown7":case"rx":t.write=!0}return t}Object.values(it.services).forEach((e=>{if(!e.characteristics)return;const t=Object.keys(e.characteristics);t.forEach((s=>{const i=e.characteristics[s];nt.includes(e.uuid)&&(ot.push(i.uuid),t.push(s)),ct.push(i.uuid)}))}),[]),Qe.log({serviceUUIDs:nt,optionalServiceUUIDs:rt,characteristicUUIDs:ot,allCharacteristicUUIDs:ct});const ut=k("BluetoothConnectionManager",{log:!0});class dt extends Ke{constructor(){super(...arguments),this.isInRange=!0}onCharacteristicValueChanged(e,t){switch(e){case"batteryLevel":case"firmwareRevision":case"hardwareRevision":case"manufacturerName":case"modelNumber":case"pnpId":case"serialNumber":case"softwareRevision":case"tapData":case"mouseData":case"airGesture":case"tx":this.onMessageReceived?.(e,t)}}async writeCharacteristic(e,t){ut.log("writeCharacteristic",...arguments)}async sendUICommandsData(e){super.sendUICommandsData(e),await this.writeCharacteristic("uiCommands",e)}async sendRxData(e){super.sendRxData(e),await this.writeCharacteristic("rx",e)}}var ft,gt,vt,mt,pt,wt,bt,yt,Et,Dt,Mt;const Ct=k("WebBluetoothConnectionManager",{log:!0});var St,Wt,kt;n&&(St=window.navigator.bluetooth);class Rt extends dt{constructor(){super(...arguments),ft.add(this),gt.set(this,{characteristicvaluechanged:t(this,ft,"m",Et).bind(this)}),vt.set(this,{gattserverdisconnected:t(this,ft,"m",Mt).bind(this)}),mt.set(this,void 0),pt.set(this,new Map),wt.set(this,new Map)}get bluetoothId(){return this.device?.id||""}get name(){return this.device?.name||""}static get isSupported(){return Boolean(St)}static get type(){return"webBluetooth"}get device(){return t(this,mt,"f")}set device(e){t(this,mt,"f")!=e?(t(this,mt,"f")&&He(t(this,mt,"f"),t(this,vt,"f")),e&&qe(e,t(this,vt,"f")),s(this,mt,e,"f")):Ct.log("tried to assign the same BluetoothDevice")}get server(){return t(this,mt,"f")?.gatt}get isConnected(){return this.server?.connected||!1}async connect(){await super.connect();try{const e=await St.requestDevice({filters:[{services:nt}],optionalServices:n?rt:[]});Ct.log("got BluetoothDevice"),this.device=e,Ct.log("connecting to device...");const s=await this.server.connect();Ct.log(`connected to device? ${s.connected}`),await t(this,ft,"m",bt).call(this),Ct.log("fully connected"),this.status="connected"}catch(e){Ct.error(e),this.status="notConnected",this.server?.disconnect(),t(this,ft,"m",yt).call(this)}}async disconnect(){await t(this,ft,"m",yt).call(this),await super.disconnect(),this.server?.disconnect(),this.status="notConnected"}async writeCharacteristic(e,s){super.writeCharacteristic(e,s);const i=t(this,wt,"f").get(e);Ct.assertWithError(i,`${e} characteristic not found`),Ct.log("writing characteristic",i,s);const n=i.properties||lt(e);n.writeWithoutResponse?(Ct.log("writing without response"),await i.writeValueWithoutResponse(s)):(Ct.log("writing with response"),await i.writeValueWithResponse(s)),Ct.log("wrote characteristic"),n.read&&!n.notify&&(Ct.log("reading value after write..."),await i.readValue(),(c||h)&&t(this,ft,"m",Dt).call(this,i))}get canReconnect(){return Boolean(this.server&&!this.server.connected&&this.isInRange)}async reconnect(){await super.reconnect(),Ct.log("attempting to reconnect..."),this.status="connecting";try{await this.server.connect()}catch(e){Ct.error(e),this.isInRange=!1}this.isConnected?(Ct.log("successfully reconnected!"),await t(this,ft,"m",bt).call(this),this.status="connected"):(Ct.log("unable to reconnect"),this.status="notConnected")}}function Lt(e,t=0,s=1){return Math.max(t,Math.min(s,e))}gt=new WeakMap,vt=new WeakMap,mt=new WeakMap,pt=new WeakMap,wt=new WeakMap,ft=new WeakSet,bt=async function(){t(this,ft,"m",yt).call(this),Ct.log("getting services...");const e=await this.server.getPrimaryServices();Ct.log("got services",e);const s=await this.server.getPrimaryService("6e400001-b5a3-f393-e0a9-e50e24dcca9e");Ct.log("got nus service",s),Ct.log("getting characteristics...");for(const s in e){const i=e[s];Ct.log({service:i});const n=at(i.uuid);Ct.assertWithError(n,`no name found for service uuid "${i.uuid}"`),Ct.log(`got "${n}" service`),i.name=n,t(this,pt,"f").set(n,i),Ct.log(`getting characteristics for "${n}" service`);const r=await i.getCharacteristics();Ct.log(`got characteristics for "${n}" service`);for(const e in r){const s=r[e];Ct.log({characteristic:s});const i=ht(s.uuid);Ct.assertWithError(Boolean(i),`no name found for characteristic uuid "${s.uuid}" in "${n}" service`),Ct.log(`got "${i}" characteristic in "${n}" service`),s.name=i,t(this,wt,"f").set(i,s),qe(s,t(this,gt,"f"));const a=s.properties||lt(i);a.notify&&(Ct.log(`starting notifications for "${i}" characteristic`),await s.startNotifications()),a.read&&(Ct.log(`reading "${i}" characteristic...`),await s.readValue(),(c||h)&&t(this,ft,"m",Dt).call(this,s))}}},yt=async function(){this.device&&He(this.device,t(this,vt,"f"));const e=Array.from(t(this,wt,"f").keys()).map((e=>{const s=t(this,wt,"f").get(e);He(s,t(this,gt,"f"));if((s.properties||lt(e)).notify)return Ct.log(`stopping notifications for "${e}" characteristic`),s.stopNotifications()}));return Promise.allSettled(e)},Et=function(e){Ct.log("oncharacteristicvaluechanged");const s=e.target;t(this,ft,"m",Dt).call(this,s)},Dt=function(e){Ct.log("onCharacteristicValue");const t=e.name;Ct.assertWithError(Boolean(t),`no name found for characteristic with uuid "${e.uuid}"`),Ct.log(`oncharacteristicvaluechanged for "${t}" characteristic`);const s=e.value;Ct.assertWithError(s,`no data found for "${t}" characteristic`),Ct.log(`data for "${t}" characteristic`,Array.from(new Uint8Array(s.buffer)));try{this.onCharacteristicValueChanged(t,s)}catch(e){Ct.error(e)}},Mt=function(){Ct.log("gattserverdisconnected"),this.status="notConnected"},k("MathUtils",{log:!0});const It=k("VibrationManager");class At{constructor(){Wt.add(this),X(this)}async vibrate(e){It.log("triggering vibration segments",e);const s=t(this,Wt,"m",kt).call(this,e);await this.sendUICommandsData(s?.buffer)}}var $t,xt,Tt,Ut,Ot,Bt,Nt,Ft,jt,Vt,Gt,_t,Pt,zt,Jt,Kt;Wt=new WeakSet,kt=function(e){const t=new DataView(new ArrayBuffer(20));let s=0;t.setUint8(s++,0),t.setUint8(s++,2);for(let s=0;s<e.length&&s<18;s++){let i=e[s];i/=10,i=Lt(i,0,255),It.log(`vibration segment #${s}: ${i}`),t.setUint8(2+s,i)}return t};const Xt=k("DeviceManager",{log:!0}),qt=["deviceConnected","deviceDisconnected","deviceIsConnected","availableDevices","connectedDevices"];class Ht{constructor(){if($t.add(this),xt.set(this,{isConnected:t(this,$t,"m",zt).bind(this)}),Tt.set(this,[]),Ut.set(this,!1),Ot.set(this,{devices:[]}),Bt.set(this,void 0),Ft.set(this,"TS.Device"),Gt.set(this,[]),_t.set(this,new L(this,qt)),Ht.shared&&this!=Ht.shared)throw Error("DeviceManager is a singleton - use DeviceManager.shared");this.CanUseLocalStorage&&(this.UseLocalStorage=!0)}onDevice(e){qe(e,t(this,xt,"f"))}OnDeviceConnectionStatusUpdated(e,s){if("notConnected"==s&&!e.canReconnect&&t(this,Gt,"f").includes(e)){const s=t(this,Gt,"f").indexOf(e);this.AvailableDevices.splice(s,1),t(this,$t,"m",Jt).call(this)}}get ConnectedDevices(){return t(this,Tt,"f")}get UseLocalStorage(){return t(this,Ut,"f")}set UseLocalStorage(e){t(this,$t,"m",Nt).call(this),Xt.assertTypeWithError(e,"boolean"),s(this,Ut,e,"f"),t(this,Ut,"f")&&!t(this,Bt,"f")&&t(this,$t,"m",Vt).call(this)}get CanUseLocalStorage(){return n&&window.localStorage}get AvailableDevices(){return t(this,Gt,"f")}get CanGetDevices(){return n&&navigator.bluetooth?.getDevices}async GetDevices(){if(!n)return void Xt.warn("GetDevices is only available in the browser");if(!navigator.bluetooth)return void Xt.warn("bluetooth is not available in this browser");if(c)return void Xt.warn("bluefy lists too many devices...");if(!navigator.bluetooth.getDevices)return void Xt.warn("bluetooth.getDevices() is not available in this browser");if(!this.CanGetDevices)return void Xt.log("CanGetDevices is false");t(this,Bt,"f")||t(this,$t,"m",Vt).call(this);const e=t(this,Bt,"f");if(!e.devices||0==e.devices.length)return void Xt.log("no devices found in configuration");const s=await navigator.bluetooth.getDevices();return Xt.log({bluetoothDevices:s}),s.forEach((s=>{if(!s.gatt)return;if(!e.devices.find((e=>s.id==e.bluetoothId)))return;let i=this.ConnectedDevices.filter((e=>"webBluetooth"==e.connectionType)).find((e=>e.bluetoothId==s.id));const n=this.AvailableDevices.filter((e=>"webBluetooth"==e.connectionType)).find((e=>e.bluetoothId==s.id));if(n)return void(i&&i?.bluetoothId==n.bluetoothId&&i!=n&&(this.AvailableDevices[t(this,Gt,"f").indexOf(n)]=i));if(i)return void this.AvailableDevices.push(i);const r=new Ys,a=new Rt;a.device=s,s.name,r.connectionManager=a,this.AvailableDevices.push(r)})),t(this,$t,"m",Jt).call(this),this.AvailableDevices}get AddEventListener(){return t(this,_t,"f").addEventListener}get RemoveEventListener(){return t(this,_t,"f").removeEventListener}get RemoveEventListeners(){return t(this,_t,"f").removeEventListeners}get RemoveAllEventListeners(){return t(this,_t,"f").removeAllEventListeners}}xt=new WeakMap,Tt=new WeakMap,Ut=new WeakMap,Ot=new WeakMap,Bt=new WeakMap,Ft=new WeakMap,Gt=new WeakMap,_t=new WeakMap,$t=new WeakSet,Nt=function(){Xt.assertWithError(n,"localStorage is only available in the browser"),Xt.assertWithError(window.localStorage,"localStorage not found")},jt=function(){t(this,$t,"m",Nt).call(this),localStorage.setItem(t(this,Ft,"f"),JSON.stringify(t(this,Bt,"f")))},Vt=async function(){t(this,$t,"m",Nt).call(this);let e=localStorage.getItem(t(this,Ft,"f"));if("string"!=typeof e)return Xt.log("no info found in localStorage"),s(this,Bt,Object.assign({},t(this,Ot,"f")),"f"),void t(this,$t,"m",jt).call(this);try{const t=JSON.parse(e);Xt.log({configuration:t}),s(this,Bt,t,"f"),this.CanGetDevices&&await this.GetDevices()}catch(e){Xt.error(e)}},Pt=function(){return t(this,_t,"f").dispatchEvent},zt=function(e){const{target:s}=e;if(s.isConnected)if(t(this,Tt,"f").includes(s))Xt.log("device already included");else{if(Xt.log("adding device",s),t(this,Tt,"f").push(s),this.UseLocalStorage&&"webBluetooth"==s.connectionType){const e={bluetoothId:s.bluetoothId},i=t(this,Bt,"f").devices.findIndex((t=>t.bluetoothId==e.bluetoothId));-1==i?t(this,Bt,"f").devices.push(e):t(this,Bt,"f").devices[i]=e,t(this,$t,"m",jt).call(this)}t(this,$t,"a",Pt).call(this,"deviceConnected",{device:s}),t(this,$t,"a",Pt).call(this,"deviceIsConnected",{device:s}),t(this,$t,"m",Kt).call(this)}else t(this,Tt,"f").includes(s)?(Xt.log("removing device",s),t(this,Tt,"f").splice(t(this,Tt,"f").indexOf(s),1),t(this,$t,"a",Pt).call(this,"deviceDisconnected",{device:s}),t(this,$t,"a",Pt).call(this,"deviceIsConnected",{device:s}),t(this,$t,"m",Kt).call(this)):Xt.log("device already not included");if(this.CanGetDevices&&this.GetDevices(),s.isConnected&&!this.AvailableDevices.includes(s)){const e=this.AvailableDevices.find((e=>e.bluetoothId==s.bluetoothId));Xt.log({existingAvailableDevice:e}),e?this.AvailableDevices[this.AvailableDevices.indexOf(e)]=s:this.AvailableDevices.push(s),t(this,$t,"m",Jt).call(this)}},Jt=function(){Xt.log({AvailableDevices:this.AvailableDevices}),t(this,$t,"a",Pt).call(this,"availableDevices",{availableDevices:this.AvailableDevices})},Kt=function(){Xt.log({ConnectedDevices:this.ConnectedDevices}),t(this,$t,"a",Pt).call(this,"connectedDevices",{connectedDevices:this.ConnectedDevices})},Ht.shared=new Ht;var Qt,Yt,Zt,es,ts,ss,is,ns=Ht.shared;const rs=k("InputManager"),as=["controller","text","rawSensor","controllerWithMouse","controllerWithMouseAndKeyboard"],os={controller:1,text:0,rawSensor:10,controllerWithMouse:3,controllerWithMouseAndKeyboard:5};class cs{constructor(){Qt.add(this),Yt.set(this,Object.assign({},fe)),Zt.set(this,"controller"),ss.set(this,new T(t(this,Qt,"m",is).bind(this),1e4)),X(this)}get sensitivity(){return t(this,Yt,"f")}set sensitivity(e){Object.assign(t(this,Yt,"f"),e)}setSensitivityForType(e,s){ve(e,s),rs.log(`setting ${e} sensitivity index to ${s}`),t(this,Yt,"f")[e]=s}get mode(){return t(this,Zt,"f")}set mode(e){t(this,Qt,"m",es).call(this,e),this.mode!=e?(s(this,Zt,e,"f"),t(this,ss,"f").isRunning&&t(this,ss,"f").restart(!0)):rs.log(`redundant mode assignment "${e}"`)}setMode(e){this.mode=e}start(){t(this,ss,"f").start(!0)}stop(){t(this,ss,"f").stop()}}var hs,ls,us,ds,fs,gs;Yt=new WeakMap,Zt=new WeakMap,ss=new WeakMap,Qt=new WeakSet,es=function(e){rs.assertEnumWithError(e,as)},ts=function(){const e=os[this.mode];let t=[];var s;"rawSensor"==this.mode&&(rs.assertWithError(this.sensitivity,"no sensitivity defined for rawSensor input mode"),s=this.sensitivity,ue.forEach((e=>{ve(e,s[e])})),ue.forEach((e=>{t.push(this.sensitivity[e])})));return pe(3,12,0,e,t)},is=function(){rs.log("sending mode data...");const e=t(this,Qt,"m",ts).call(this);this.sendRxData(e)};const vs=k("XRStateManager"),ms=["user","airMouse","tapping","dontSend"],ps={user:3,airMouse:1,tapping:2};class ws{constructor(){hs.add(this),ls.set(this,"user"),fs.set(this,new T(t(this,hs,"m",gs).bind(this),1e4)),X(this)}get state(){return t(this,ls,"f")}set state(e){t(this,hs,"m",us).call(this,e),this.state!=e?(s(this,ls,e,"f"),t(this,fs,"f").isRunning&&t(this,fs,"f").restart(!0)):vs.log(`redundant state assignment "${e}"`)}setState(e){this.state=e}start(){t(this,fs,"f").start(!0)}stop(){t(this,fs,"f").stop()}}var bs,ys,Es,Ds,Ms,Cs,Ss,Ws,ks,Rs,Ls,Is,As,$s,xs,Ts,Us,Os,Bs,Ns,Fs,js,Vs,Gs,_s,Ps,zs,Js,Ks,Xs,qs;ls=new WeakMap,fs=new WeakMap,hs=new WeakSet,us=function(e){vs.assertEnumWithError(e,ms)},ds=function(){const e=ps[this.state];vs.assert(null!=e,`no stateByte found for state "${this.state}"`);return pe(3,13,0,e)},gs=function(){if("dontSend"==this.state)return;vs.log("sending state data...");const e=t(this,hs,"m",ds).call(this);this.sendRxData(e)};const Hs=k("Device",{log:!0}),Qs=["connectionMessage",...Je,"batteryLevel",...J,...Y,...ie,...ce,...xe];class Ys{get bluetoothId(){return t(this,Cs,"f")?.bluetoothId}get name(){return t(this,Cs,"f")?.name}constructor(){bs.add(this),Ds.set(this,new L(this,Qs)),Cs.set(this,void 0),this.sendUICommandsData=t(this,bs,"m",Ss).bind(this),this.sendRxData=t(this,bs,"m",Ws).bind(this),ks.set(this,!1),As.set(this,ys.ReconnectOnDisconnection),$s.set(this,void 0),this.latestConnectionMessage=new Map,Fs.set(this,new K),js.set(this,0),Gs.set(this,new cs),_s.set(this,new ws),Ps.set(this,new Z),zs.set(this,new ne),Js.set(this,new he),Ks.set(this,new Te),Xs.set(this,new At),qs.set(this,!1),t(this,Fs,"f").eventDispatcher=t(this,Ds,"f"),t(this,Gs,"f").sendRxData=this.sendRxData,t(this,_s,"f").sendRxData=this.sendRxData,t(this,Ps,"f").eventDispatcher=t(this,Ds,"f"),t(this,zs,"f").eventDispatcher=t(this,Ds,"f"),t(this,Js,"f").eventDispatcher=t(this,Ds,"f"),t(this,Ks,"f").eventDispatcher=t(this,Ds,"f"),t(this,Xs,"f").sendUICommandsData=this.sendUICommandsData,t(this,Ks,"f").rawSensorSensitivity=t(this,Gs,"f").sensitivity,this.addEventListener("hardwareRevision",(()=>{})),this.addEventListener("isConnected",(()=>{this.isConnected?t(this,Gs,"f").start():t(this,Gs,"f").stop()})),ns.onDevice(this),n&&window.addEventListener("beforeunload",(()=>{this.isConnected})),r&&process.on("exit",(()=>{this.isConnected}))}get addEventListener(){return t(this,Ds,"f").addEventListener}get removeEventListener(){return t(this,Ds,"f").removeEventListener}get waitForEvent(){return t(this,Ds,"f").waitForEvent}get removeEventListeners(){return t(this,Ds,"f").removeEventListeners}get removeAllEventListeners(){return t(this,Ds,"f").removeAllEventListeners}get connectionManager(){return t(this,Cs,"f")}set connectionManager(e){this.connectionManager!=e?(this.connectionManager&&(this.connectionManager.onStatusUpdated=void 0,this.connectionManager.onMessageReceived=void 0,this.connectionManager.onMessagesReceived=void 0),e&&(e.onStatusUpdated=t(this,bs,"m",xs).bind(this),e.onMessageReceived=t(this,bs,"m",Bs).bind(this),e.onMessagesReceived=t(this,bs,"m",Ns).bind(this)),s(this,Cs,e,"f"),Hs.log("assigned new connectionManager",t(this,Cs,"f"))):Hs.log("same connectionManager is already assigned")}async connect(){return this.connectionManager||(this.connectionManager=t(ys,ys,"m",Es).call(ys)),t(this,bs,"m",Os).call(this),this.connectionManager.connect()}get isConnected(){return t(this,ks,"f")}get canReconnect(){return this.connectionManager?.canReconnect}async reconnect(){return t(this,bs,"m",Ls).call(this),t(this,bs,"m",Os).call(this),this.connectionManager?.reconnect()}static async Connect(){const e=new ys;return await e.connect(),e}static get ReconnectOnDisconnection(){return t(this,ys,"f",Is)}static set ReconnectOnDisconnection(e){Hs.assertTypeWithError(e,"boolean"),s(this,ys,e,"f",Is)}get reconnectOnDisconnection(){return t(this,As,"f")}set reconnectOnDisconnection(e){Hs.assertTypeWithError(e,"boolean"),s(this,As,e,"f")}get connectionType(){return this.connectionManager?.type}async disconnect(){return t(this,bs,"m",Rs).call(this),this.reconnectOnDisconnection&&(this.reconnectOnDisconnection=!1,this.addEventListener("isConnected",(()=>{this.reconnectOnDisconnection=!0}),{once:!0})),this.connectionManager.disconnect()}toggleConnection(){this.isConnected?this.disconnect():this.canReconnect?this.reconnect():this.connect()}get connectionStatus(){switch(t(this,Cs,"f")?.status){case"connected":return this.isConnected?"connected":"connecting";case"notConnected":case"connecting":case"disconnecting":return t(this,Cs,"f").status;default:return"notConnected"}}get isConnectionBusy(){return"connecting"==this.connectionStatus||"disconnecting"==this.connectionStatus}get deviceInformation(){return t(this,Fs,"f").information}get batteryLevel(){return t(this,js,"f")}get setInputMode(){return t(this,Gs,"f").setMode}get setSensitivityForType(){return t(this,Gs,"f").setSensitivityForType}get setXRState(){return t(this,_s,"f").setState}get vibrate(){return t(this,Xs,"f").vibrate}get isServerSide(){return t(this,qs,"f")}set isServerSide(e){t(this,qs,"f")!=e?(Hs.log({newIsServerSide:e}),s(this,qs,e,"f")):Hs.log("redundant isServerSide assignment")}}var Zs,ei,ti;ys=Ys,Ds=new WeakMap,Cs=new WeakMap,ks=new WeakMap,As=new WeakMap,$s=new WeakMap,Fs=new WeakMap,js=new WeakMap,Gs=new WeakMap,_s=new WeakMap,Ps=new WeakMap,zs=new WeakMap,Js=new WeakMap,Ks=new WeakMap,Xs=new WeakMap,qs=new WeakMap,bs=new WeakSet,Es=function(){return new Rt},Ms=function(){return t(this,Ds,"f").dispatchEvent},Ss=async function(e){await(t(this,Cs,"f")?.sendUICommandsData(e))},Ws=async function(e){await(t(this,Cs,"f")?.sendRxData(e))},Rs=function(){Hs.assertWithError(this.isConnected,"notConnected")},Ls=function(){Hs.assertWithError(this.canReconnect,"cannot reconnect to device")},xs=function(e){Hs.log({connectionStatus:e}),"notConnected"==e?this.canReconnect&&this.reconnectOnDisconnection&&(Hs.log("starting reconnect interval..."),s(this,$s,setInterval((()=>{Hs.log("attempting reconnect..."),this.reconnect()}),1e3),"f")):null!=t(this,$s,"f")&&(Hs.log("clearing reconnect interval"),clearInterval(t(this,$s,"f")),s(this,$s,void 0,"f")),t(this,bs,"m",Us).call(this),"connected"==e&&t(this,ks,"f"),ns.OnDeviceConnectionStatusUpdated(this,e)},Ts=function(e=!1){t(this,bs,"a",Ms).call(this,"connectionStatus",{connectionStatus:this.connectionStatus}),t(this,bs,"a",Ms).call(this,this.connectionStatus,{}),e&&t(this,bs,"a",Ms).call(this,"isConnected",{isConnected:this.isConnected})},Us=function(){switch(s(this,ks,Boolean(this.connectionManager?.isConnected),"f"),this.connectionStatus){case"connected":t(this,ks,"f")&&t(this,bs,"m",Ts).call(this,!0);break;case"notConnected":t(this,bs,"m",Ts).call(this,!0);break;default:t(this,bs,"m",Ts).call(this,!1)}},Os=function(){this.latestConnectionMessage.clear(),t(this,Fs,"f").clear()},Bs=function(e,s){if(Hs.log({messageType:e,dataView:s}),"batteryLevel"===e){const e=s.getUint8(0);Hs.log("received battery level",{batteryLevel:e}),t(this,bs,"m",Vs).call(this,e)}else if(z.includes(e))t(this,Fs,"f").parseMessage(e,s);else if(Q.includes(e))t(this,Ps,"f").parseMessage(e,s);else if(se.includes(e))t(this,zs,"f").parseMessage(e,s);else if(oe.includes(e))t(this,Js,"f").parseMessage(e,s);else{if(!$e.includes(e))throw Error(`uncaught messageType "${e}"`);t(this,Ks,"f").parseMessage(e,s)}this.latestConnectionMessage.set(e,s),t(this,bs,"a",Ms).call(this,"connectionMessage",{messageType:e,dataView:s})},Ns=function(){this.isConnected||t(this,bs,"m",Us).call(this)},Vs=function(e){Hs.assertTypeWithError(e,"number"),t(this,js,"f")!=e?(s(this,js,e,"f"),Hs.log({updatedBatteryLevel:t(this,js,"f")}),t(this,bs,"a",Ms).call(this,"batteryLevel",{batteryLevel:t(this,js,"f")})):Hs.log(`duplicate batteryLevel assignment ${e}`)},Is={value:!1};const si={min:1/0,max:-1/0,span:0};ei=new WeakMap,Zs=new WeakSet,ti=function(){t(this,ei,"f").span=t(this,ei,"f").max-t(this,ei,"f").min},e.Device=Ys,e.DeviceManager=ns,e.Environment=b,e.InputModes=as,e.MaxNumberOfVibrationSegments=18,e.MaxNumberOfVibrations=9,e.RangeHelper=class{constructor(){Zs.add(this),ei.set(this,Object.assign({},si))}get min(){return t(this,ei,"f").min}get max(){return t(this,ei,"f").max}set min(e){t(this,ei,"f").min=e,t(this,ei,"f").max=Math.max(e,t(this,ei,"f").max),t(this,Zs,"m",ti).call(this)}set max(e){t(this,ei,"f").max=e,t(this,ei,"f").min=Math.min(e,t(this,ei,"f").min),t(this,Zs,"m",ti).call(this)}reset(){Object.assign(t(this,ei,"f"),si)}update(e){t(this,ei,"f").min=Math.min(e,t(this,ei,"f").min),t(this,ei,"f").max=Math.max(e,t(this,ei,"f").max),t(this,Zs,"m",ti).call(this)}getNormalization(e,s){let i=function(e,t,s,i){return null==i&&(i=s-t),(e-t)/i}(e,t(this,ei,"f").min,t(this,ei,"f").max,t(this,ei,"f").span);return s&&(i*=t(this,ei,"f").span),i||0}updateAndGetNormalization(e,t){return this.update(e),this.getNormalization(e,t)}},e.RawSensorSensitivityFactors=de,e.RawSensorTypes=ue,e.setAllConsoleLevelFlags=function(e){W.setAllLevelFlags(e)},e.setConsoleLevelFlagsForType=function(e,t){W.setLevelFlagsForType(e,t)}}));
//# sourceMappingURL=tapstrap.min.js.map
